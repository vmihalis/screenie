# Phase 2: Device Registry - Research Findings

## 1. Device Viewport Data

### 1.1 Apple iPhones (2022-2024)

| Device | Viewport (CSS px) | Resolution (Physical) | DPR | Release |
|--------|-------------------|----------------------|-----|---------|
| iPhone 16 Pro Max | 440 x 956 | 1320 x 2868 | 3 | 2024 |
| iPhone 16 Pro | 402 x 874 | 1206 x 2622 | 3 | 2024 |
| iPhone 16 Plus | 430 x 932 | 1290 x 2796 | 3 | 2024 |
| iPhone 16 | 393 x 852 | 1179 x 2556 | 3 | 2024 |
| iPhone 15 Pro Max | 430 x 932 | 1290 x 2796 | 3 | 2023 |
| iPhone 15 Pro | 393 x 852 | 1179 x 2556 | 3 | 2023 |
| iPhone 15 Plus | 428 x 926 | 1284 x 2778 | 3 | 2023 |
| iPhone 15 | 390 x 844 | 1170 x 2532 | 3 | 2023 |
| iPhone 14 Pro Max | 430 x 932 | 1290 x 2796 | 3 | 2022 |
| iPhone 14 Pro | 393 x 852 | 1179 x 2556 | 3 | 2022 |
| iPhone 14 Plus | 428 x 926 | 1284 x 2778 | 3 | 2022 |
| iPhone 14 | 390 x 844 | 1170 x 2532 | 3 | 2022 |
| iPhone SE (3rd gen) | 375 x 667 | 750 x 1334 | 2 | 2022 |
| iPhone 13 Pro Max | 428 x 926 | 1284 x 2778 | 3 | 2021 |
| iPhone 13 Pro | 390 x 844 | 1170 x 2532 | 3 | 2021 |
| iPhone 13 Mini | 360 x 780 | 1080 x 2340 | 3 | 2021 |
| iPhone 12 Pro Max | 428 x 926 | 1284 x 2778 | 3 | 2020 |
| iPhone 12 Pro | 390 x 844 | 1170 x 2532 | 3 | 2020 |
| iPhone 12 Mini | 375 x 812 | 1125 x 2436 | 3 | 2020 |

### 1.2 Samsung Galaxy Phones (2022-2024)

| Device | Viewport (CSS px) | Resolution (Physical) | DPR | Release |
|--------|-------------------|----------------------|-----|---------|
| Galaxy S24 Ultra | 384 x 824 | 1440 x 3120 | 3.75 | 2024 |
| Galaxy S24+ | 384 x 854 | 1344 x 2992 | 3.5 | 2024 |
| Galaxy S24 | 360 x 780 | 1080 x 2340 | 3 | 2024 |
| Galaxy S23 Ultra | 412 x 915 | 1440 x 3200 | 3.5 | 2023 |
| Galaxy S23+ | 384 x 854 | 1080 x 2340 | 2.8 | 2023 |
| Galaxy S23 | 360 x 780 | 1080 x 2340 | 3 | 2023 |
| Galaxy Z Fold 5 (main) | 384 x 832 | 1812 x 2176 | 3 | 2023 |
| Galaxy Z Flip 5 | 412 x 915 | 1080 x 2640 | 2.6 | 2023 |
| Galaxy S22 Ultra | 412 x 915 | 1440 x 3200 | 3.5 | 2022 |
| Galaxy S22+ | 384 x 824 | 1080 x 2340 | 2.8 | 2022 |
| Galaxy S22 | 360 x 780 | 1080 x 2340 | 3 | 2022 |

### 1.3 Google Pixel Phones (2022-2024)

| Device | Viewport (CSS px) | Resolution (Physical) | DPR | Release |
|--------|-------------------|----------------------|-----|---------|
| Pixel 8 Pro | 448 x 998 | 1344 x 2992 | 3 | 2023 |
| Pixel 8 | 412 x 915 | 1080 x 2400 | 2.625 | 2023 |
| Pixel 7 Pro | 412 x 892 | 1440 x 3120 | 3.5 | 2022 |
| Pixel 7 | 412 x 915 | 1080 x 2400 | 2.6 | 2022 |
| Pixel 7a | 412 x 915 | 1080 x 2400 | 2.6 | 2023 |
| Pixel 6 Pro | 412 x 892 | 1440 x 3120 | 3.5 | 2021 |
| Pixel 6 | 412 x 915 | 1080 x 2400 | 2.6 | 2021 |
| Pixel 6a | 412 x 915 | 1080 x 2400 | 2.6 | 2022 |

### 1.4 Apple iPads (Tablets)

| Device | Viewport (CSS px) | Resolution (Physical) | DPR | Release |
|--------|-------------------|----------------------|-----|---------|
| iPad Pro 12.9" (2024) | 1024 x 1366 | 2048 x 2732 | 2 | 2024 |
| iPad Pro 11" (2024) | 834 x 1194 | 1668 x 2388 | 2 | 2024 |
| iPad Air (2024) | 820 x 1180 | 1640 x 2360 | 2 | 2024 |
| iPad Pro 12.9" (2022) | 1024 x 1366 | 2048 x 2732 | 2 | 2022 |
| iPad Pro 11" (2022) | 834 x 1194 | 1668 x 2388 | 2 | 2022 |
| iPad Air (2022) | 820 x 1180 | 1640 x 2360 | 2 | 2022 |
| iPad 10th Gen | 820 x 1180 | 1640 x 2360 | 2 | 2022 |
| iPad Mini (2021) | 768 x 1024 | 1536 x 2048 | 2 | 2021 |
| iPad 9th Gen | 810 x 1080 | 1620 x 2160 | 2 | 2021 |
| iPad Mini 7th Gen | 744 x 1133 | 1488 x 2266 | 2 | 2024 |

### 1.5 Samsung Galaxy Tabs (Tablets)

| Device | Viewport (CSS px) | Resolution (Physical) | DPR | Release |
|--------|-------------------|----------------------|-----|---------|
| Galaxy Tab S9 Ultra | 820 x 1138 | 1848 x 2960 | 2.25 | 2023 |
| Galaxy Tab S9+ | 820 x 1138 | 1752 x 2800 | 2.14 | 2023 |
| Galaxy Tab S9 | 753 x 1205 | 1600 x 2560 | 2.125 | 2023 |
| Galaxy Tab S8 Ultra | 820 x 1138 | 1848 x 2960 | 2.25 | 2022 |
| Galaxy Tab S8+ | 820 x 1138 | 1752 x 2800 | 2.14 | 2022 |
| Galaxy Tab S8 | 753 x 1205 | 1600 x 2560 | 2.125 | 2022 |
| Galaxy Tab S7 | 800 x 1280 | 1600 x 2560 | 2 | 2020 |

### 1.6 Desktop/Laptop Viewports

Common desktop viewport sizes based on 2024 global statistics:

| Resolution | Market Share | Description |
|------------|--------------|-------------|
| 1920 x 1080 | ~19% | Full HD - Most common desktop |
| 1536 x 864 | ~7% | Common laptop (scaled) |
| 1366 x 768 | ~6% | HD laptop (older standard) |
| 3840 x 2160 | ~5% | 4K displays |
| 1280 x 720 | ~5% | HD (720p) |
| 2560 x 1440 | ~4% | QHD displays |
| 1440 x 900 | ~3% | MacBook Air (older) |
| 1680 x 1050 | ~2% | WSXGA+ |

**Key Desktop Breakpoints for Testing:**
- Small laptop: 1280 x 720 (DPR 1)
- Standard laptop: 1366 x 768 (DPR 1)
- HD laptop: 1536 x 864 (DPR 1.25)
- Full HD: 1920 x 1080 (DPR 1)
- QHD: 2560 x 1440 (DPR 1)
- 4K: 3840 x 2160 (DPR 2)
- MacBook Pro 13": 1440 x 900 (DPR 2)
- MacBook Pro 14": 1512 x 982 (DPR 2)
- MacBook Pro 16": 1728 x 1117 (DPR 2)

## 2. Playwright Device Emulation API

### 2.1 Device Descriptor Structure

Playwright uses device descriptors with these core fields:

```typescript
interface DeviceDescriptor {
  userAgent: string;           // Browser user agent string
  viewport: {                  // CSS viewport dimensions
    width: number;
    height: number;
  };
  screen?: {                   // Optional physical screen size
    width: number;
    height: number;
  };
  deviceScaleFactor: number;   // Device pixel ratio (DPR)
  isMobile: boolean;           // Affects viewport meta tag handling
  hasTouch: boolean;           // Enables touch events
  defaultBrowserType: 'chromium' | 'firefox' | 'webkit';
}
```

### 2.2 Browser Context Creation

```typescript
import { chromium, devices } from 'playwright';

// Using built-in device
const iPhone = devices['iPhone 15 Pro'];
const context = await browser.newContext({
  ...iPhone,
});

// Using custom device config
const context = await browser.newContext({
  viewport: { width: 430, height: 932 },
  deviceScaleFactor: 3,
  userAgent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_5...',
  isMobile: true,
  hasTouch: true,
});
```

### 2.3 Key API Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `viewport` | `{width, height}` or `null` | `{1280, 720}` | Page dimensions in CSS pixels |
| `deviceScaleFactor` | `number` | `1` | Device pixel ratio |
| `isMobile` | `boolean` | `false` | Mobile viewport meta handling |
| `hasTouch` | `boolean` | `false` | Enable touch events |
| `userAgent` | `string` | Browser default | Custom user agent string |

### 2.4 Playwright Built-in Devices Reference

Playwright maintains device descriptors at:
- Source: `playwright-core/src/server/deviceDescriptorsSource.json`
- Access via: `playwright.devices['Device Name']`

Example built-in devices include landscape variants (`iPhone 15 Pro landscape`).

## 3. deviceScaleFactor (DPR) Reference

### 3.1 Understanding DPR

**Device Pixel Ratio (DPR)** = Physical Pixels / CSS Pixels

| DPR | Meaning | Common Devices |
|-----|---------|----------------|
| 1 | Standard displays | Most desktop monitors |
| 1.25 | Slight scaling | Scaled Windows laptops |
| 1.5 | Medium density | Some Windows laptops |
| 2 | Retina/HiDPI | iPhones (older), iPads, MacBooks |
| 2.625 | High density | Pixel 8 |
| 3 | Very high density | iPhones (modern), many Android flagships |
| 3.5 | Ultra high density | Galaxy S23 Ultra, Pixel Pro models |
| 3.75 | Extreme density | Galaxy S24 Ultra |

### 3.2 DPR by Device Category

**Phones:**
- Apple iPhones (2020+): DPR 3 (except SE which is DPR 2)
- Samsung Galaxy S series: DPR 3-3.75
- Google Pixel: DPR 2.6-3.5

**Tablets:**
- Apple iPads: DPR 2 (all models)
- Samsung Galaxy Tab: DPR 2-2.25

**Desktop/Laptop:**
- Standard monitors: DPR 1
- Windows scaled displays: DPR 1.25-1.5
- MacBook displays: DPR 2

### 3.3 Implementation Note

For our device registry, we should normalize DPR values to commonly supported values. Playwright supports arbitrary DPR values, but common values are: 1, 1.5, 2, 2.5, 3, 3.5.

## 4. Recommended Categorization

### 4.1 Category Structure

```typescript
type DeviceCategory =
  | 'phones'      // Mobile phones (< 7" diagonal)
  | 'tablets'     // Tablets (7"-13" diagonal)
  | 'desktops';   // Desktops and laptops (13"+)
```

### 4.2 Subcategories (Optional for Future)

```typescript
type PhoneSubcategory = 'small' | 'standard' | 'large' | 'foldable';
type TabletSubcategory = 'mini' | 'standard' | 'large';
type DesktopSubcategory = 'laptop' | 'desktop' | 'ultrawide';
```

### 4.3 Recommended Device Count

To meet the 50+ device requirement:

| Category | Target Count | Notes |
|----------|--------------|-------|
| Phones | 20+ | iPhone (8), Samsung (8), Pixel (5+) |
| Tablets | 12+ | iPad (6), Galaxy Tab (4), generic (2+) |
| Desktops | 18+ | Standard sizes (8), MacBooks (4), 4K (2), generic (4+) |
| **Total** | **50+** | |

## 5. Implementation Considerations

### 5.1 Type Definitions

```typescript
// src/devices/types.ts

export interface Device {
  name: string;                    // Human-readable name
  width: number;                   // Viewport width (CSS pixels)
  height: number;                  // Viewport height (CSS pixels)
  deviceScaleFactor: number;       // DPR
  category: DeviceCategory;
}

export type DeviceCategory = 'phones' | 'tablets' | 'desktops';

// For getDevices()
export type DeviceList = ReadonlyArray<Device>;

// For getDevicesByCategory()
export type DeviceFilter = (device: Device) => boolean;
```

### 5.2 Design Decisions

1. **Viewport Heights**: Use browser-visible heights (accounting for browser chrome), not full screen heights. Playwright's viewport height represents the visible content area.

2. **Landscape Variants**: Consider whether to include landscape variants as separate devices or provide a utility function to calculate landscape dimensions.

3. **User Agent Strings**: Our simplified Device interface omits userAgent since we focus on visual testing. Playwright's screenshot API works without custom UA.

4. **Immutability**: Export devices as `readonly` arrays to prevent accidental mutation.

5. **Naming Convention**: Use consistent naming like:
   - `iPhone 15 Pro Max` (not "Apple iPhone 15 Pro Max")
   - `Galaxy S24 Ultra` (not "Samsung Galaxy S24 Ultra")
   - `MacBook Pro 16"` (with quotes around inch symbol)

### 5.3 API Design

```typescript
// src/devices/index.ts

// Get all devices
export function getDevices(): DeviceList;

// Filter by category
export function getDevicesByCategory(category: DeviceCategory): DeviceList;

// Optional: Get specific device
export function getDevice(name: string): Device | undefined;
```

### 5.4 Data Organization

Consider organizing device data by category for maintainability:

```
src/devices/
  types.ts          # Type definitions
  phones.ts         # Phone device data
  tablets.ts        # Tablet device data
  desktops.ts       # Desktop device data
  index.ts          # Exports getDevices(), getDevicesByCategory()
```

### 5.5 Validation Considerations

- Ensure all devices have positive width/height values
- Ensure deviceScaleFactor is between 1 and 4
- Ensure category is a valid DeviceCategory
- Consider runtime validation or compile-time `as const` assertions

## 6. Sources

### Device Viewport Data
- [iOS Resolution](https://www.ios-resolution.com/) - Comprehensive iPhone/iPad data
- [Blisk Device Database](https://blisk.io/devices) - Cross-browser testing viewports
- [YesViz](https://yesviz.com/) - Device viewport reference
- [Screen Size Checker](https://screensizechecker.com/) - iPhone, Android, iPad viewport guides
- [WebMobileFirst](https://www.webmobilefirst.com/en/devices/) - Device simulator specs

### Desktop Statistics
- [StatCounter Global Stats](https://gs.statcounter.com/screen-resolution-stats) - Screen resolution market share 2024
- [BrowserStack Guide](https://browserstack.com/guide/common-screen-resolutions) - Common screen resolutions 2024

### Playwright Documentation
- [Playwright Emulation](https://playwright.dev/docs/emulation) - Official emulation guide
- [Playwright Devices Source](https://github.com/microsoft/playwright/blob/main/packages/playwright-core/src/server/deviceDescriptorsSource.json) - Built-in device descriptors
- [Context7 Playwright Docs](/microsoft/playwright.dev) - API reference

### Technical References
- [MDN devicePixelRatio](https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio) - DPR explanation
- [MDN Viewport Concepts](https://developer.mozilla.org/en-US/docs/Web/CSS/Viewport_concepts) - CSS viewport guide
